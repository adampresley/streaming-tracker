{{template "layouts/layout" .}}
{{define "title"}}Home{{end}}
{{define "content"}}

<h2>Add a Show</h2>

{{template "components/display-messages" .}}

<form action="/shows/add" method="POST" name="addShowForm" id="addShowForm">
   <fieldset>
      <label>
         Show name
         <input type="text" name="showName" id="showName" maxlength="128" minlength="1" required value="{{.ShowName}}"
            autocomplete="off">
         <small>Enter the name of the show you want to track</small>
      </label>

      <!-- Search results container -->
      <div id="searchResults" class="search-results" style="display: none;">
         <div class="search-results-header">
            <strong>Search Results</strong>
            <button type="button" id="clearSearch" class="clear-search">Ã—</button>
         </div>

         <div id="searchResultsList" class="search-results-list">
            <!-- Results will be populated here -->
         </div>

         <div id="searchLoading" class="search-loading" style="display: none;">
            <small>Searching...</small>
         </div>
      </div>

      <label>
         Total seasons
         <input type="number" name="totalSeasons" id="totalSeasons" min="1" max="255" required
            value="{{.TotalSeasons}}">
         <small>Enter the total number of seasons for this show</small>
      </label>

      <label>
         Poster image URL
         <input type="url" name="posterImage" id="posterImage" maxlength="512" value="{{.PosterImage}}"
            autocomplete="off" placeholder="https://example.com/poster.jpg">
         <small>Enter the URL of the show's poster image (optional)</small>
      </label>

      <label>
         Platform
         <select name="platform" id="platform" required>
            <option value="0">Select a platform</option>

            {{range .Platforms}}
            <option value="{{.ID.ID}}" {{if eq .ID.ID $.PlatformID}} selected{{end}}>{{.Name }}</option>
            {{end}}
         </select>
         <small>Choose the streaming platform where this show is available</small>
      </label>
   </fieldset>

   <fieldset id="watchersFieldset">
      <legend>Who wants to watch?</legend>

      {{range .Watchers}}
      <label>
         <input type="checkbox" name="watchers" value="{{.Watcher.ID.ID}}" {{if .IsSelected}}checked{{end}} />
         {{.Watcher.Name}}
      </label>
      {{end}}
      <small id="watchersHelp">Select at least one person who wants to watch this show</small>
   </fieldset>

   <input type="submit" id="submit" value="Add Show" />
</form>

<p>
   <small><em>Search results provided by <a href="https://www.tvmaze.com/" _target="_blank">TV Maze API</a></em></small>
</p>

{{end}}
